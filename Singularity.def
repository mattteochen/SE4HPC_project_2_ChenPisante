Bootstrap: docker
From: pcafrica/mk #Scientific computing image

%labels
    Maintainer kaiximatteo.chen@mail.polimi.it, giuseppe.pisante@mail.polimi.it
    Version 1.0

%files
    . /opt/build_files

%post
    apt-get update && apt-get install -y \
    build-essential \
    openmpi-bin \
    openmpi-common \
    cmake \
    libopenmpi-dev

    cd /opt/build_files
    ls -la
    rm -rf build
    chmod +x build.sh
    ./build.sh

%runscript
    export TMPDIR=/home
    echo $TMPDIR
    export OMPI_MCA_tmpdir_base=$TMPDIR && cd /opt/build_files/build &&  mpirun -np 2 main
